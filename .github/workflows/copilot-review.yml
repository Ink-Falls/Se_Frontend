name: Copilot Review

on:
  pull_request:
    types: [opened, synchronize, reopened]

# Update permissions to include write access
permissions:
  contents: write
  pull-requests: write
  issues: write
  checks: write

jobs:
  copilot-review:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Request Copilot Review
        id: copilot
        uses: github/copilot-preview@v1
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Success Message
        if: success()
        run: |
          echo "✅ Copilot review completed successfully!"
          echo "Review comments have been added to the pull request."

      - name: Error Message 
        if: failure()
        run: |
          echo "❌ Copilot review failed."
          echo "Please check the workflow logs for more details."
